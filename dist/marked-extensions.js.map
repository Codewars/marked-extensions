{"version":3,"file":"marked-extensions.js","sources":["../src/objects.js","../src/strings.js","../src/doc-tokens/doc-types.js","../src/doc-tokens/doc-names.js","../src/doc-tokens/doc-globals.js","../src/doc-tokens/index.js","../src/json-doc.js","../src/renderer.js","../src/index.js"],"sourcesContent":["/**\n * Assigns the keys from source into target, but only those that are not already assigned. Useful\n * in place of Object.assign which would require a polyfill\n * @param target\n * @param source\n * @returns {*}\n */\nexport function assignMissing (target, source) {\n  Object.keys(source || {}).forEach(key => {\n    if (!(key in target)) {\n      target[key] = source[key];\n    }\n  })\n  return target;\n}\n","export function upperCaseWords (str) {\n  if (!str) return str\n  return str.replace(/(?:^|\\s)\\S/g, a => a.toUpperCase())\n}\n\nexport function camelCase (str, pascal) {\n  const cased = upperCaseWords(str.replace(/_/g, ' ')).replace(/ /g, '')\n  return pascal ? cased : lowerCaseFirst(cased)\n}\n\nexport function lowerCaseFirst (str) {\n  return `${str[0].toLowerCase()}${str.substr(1)}`;\n}\n\nexport function escapeHtml (text) {\n  return text ? text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;') : text;\n}\n\nexport function unescapeHtml (text) {\n  return text ? text.replace(/&amp;/g, '&').replace(/&lt;/g, '<').replace(/&gt;/g, '>') : text;\n}\n","import { escapeHtml, unescapeHtml } from '../strings'\n\n/**\n * Tracks some basic types that we convert for different languages. We don't need to try to\n * maintain a list for every type for every language we support, however we do want to track some\n * common types, such as hash, void, and primary types to minimize confusion.\n *\n * We will want to expand or trim this list as needed to find a good balance between useful and\n * too much language specialization.\n *\n */\nconst TYPES = {\n  void: {\n    'undefined': ['javascript', 'coffeescript'],\n    nil: ['ruby'],\n    None: ['python']\n  },\n  'null': {\n    nil: ['ruby'],\n    NSNull: ['objc'],\n    None: ['python']\n  },\n  object: {\n    NSObject: ['objc'],\n    _alias: 'hash'\n  },\n  hash: {\n    Hash: ['ruby'],\n    dict: ['python'],\n    Dictionary: ['csharp'],\n    HashMap: ['java'],\n    Object: ['javascript', 'typescript', 'coffeescript']\n  },\n  collection: {\n    List: ['java'],\n    Collection: ['csharp'],\n    _alias: 'list'\n  },\n  array: {\n    List: ['java'],\n    'NSArray*': ['objc'],\n    'std::list': ['cpp'],\n    default: 'Array'\n  },\n  list: {\n    Array: ['javascript', 'ruby', 'python', 'typescript', 'coffeescript'],\n    'std::list': ['cpp'],\n    default: 'List'\n  },\n  string: {\n    string: ['csharp', 'typescript'],\n    'std::string': ['cpp'],\n    'char*': ['c'],\n    'NSString *': ['objc'],\n    default: 'String'\n  },\n  integer: {\n    int: ['csharp', 'cpp', 'c'],\n    Int: ['swift'],\n    'NSNumber *': ['objc'],\n    Number: ['javascript'],\n    number: ['typescript'],\n    default: 'Integer'\n  },\n  boolean: {\n    bool: ['csharp', 'c', 'cpp'],\n    Bool: ['swift'],\n    BOOL: ['objc'],\n    boolean: ['java', 'typescript'],\n    default: 'Boolean'\n  },\n  float: {\n    float: ['csharp'],\n    Number: ['javascript'],\n    default: 'Float'\n  },\n}\n\nconst NULLABLE = {\n  csharp: {\n    default: 'Nullable<@@>'\n  }\n}\n\n/**\n * Long story short this handles these types of cases\n * <code>@@docType:Array</code>\n * <code>@@docType:Array<String></code>\n * `@@docType:Array`\n * `@@docType:Array<String>`\n * `@@docType:Array<String, Int>`\n * `@@docType:Array<String,Int>`\n * @@docType:Array<String, Int>\n * @@docType:Array\n * @type {RegExp}\n */\nconst regex = /(`|<code>|<pre>)?@@docType: ?([a-zA-Z_?]*(?:(?:<|&lt;)[a-zA-Z?]*(?:(?:,|, )[a-zA-Z]*)?(?:>|&gt;))?)(`|<\\/code>|<\\/pre>)?/g;\n\n/**\n * process all @@docType: tokens and replaces them with the correct display value, and possibly wraps them in a dfn tag\n * @param language\n * @param pre Boolean that determines if we are displaying this content within a pre element, so don't wrap with dfn tags\n * @param content The content to be replaced. Can handle replacing multiple tags at once\n */\nexport function replaceDocTypes (language, pre, content) {\n  return content.replace(regex, function (shell, codeStart, value, codeEnd) {\n    const nullable = !!value.match(/\\?$/);\n    value = value.replace('?', '').trim();\n    value = unescapeHtml(value);\n\n    if (value.indexOf('<') > 0) {\n      const parts = value.split(/[<>]/);\n      value = collectionType(language, parts[0], parts[1]);\n    }\n    else {\n      value = mapType(language, value);\n    }\n\n    if (nullable) {\n      value = mapNullable(language, value);\n    }\n\n    return wrap(value, shell, pre, codeStart, codeEnd);\n  });\n}\n\nfunction mapNullable (language, value) {\n  if (NULLABLE[language]) {\n    const config = NULLABLE[language][value] || NULLABLE[language].default;\n    if (config) {\n      return config.replace('@@', value);\n    }\n  }\n\n  return value;\n}\n\n\nfunction mapType (language, type, _default) {\n  const map = TYPES[type.toLowerCase()];\n  let mapped = null;\n  if (map) {\n    Object.keys(map).forEach(key => {\n      if (!mapped) {\n        if (key === 'default') {\n          mapped = map.default;\n        }\n        // if a string, then the value is an alias to another type\n        else if (key === '_alias') {\n          mapped = mapType(language, map._alias, type);\n        }\n        else if (map[key].indexOf(language) >= 0) {\n          mapped = key;\n        }\n      }\n    })\n    return mapped || _default || type;\n  }\n\n  return type;\n}\n\nfunction collectionType (language, type, nestedType) {\n  const nestedTypes = nestedType.split(/, ?/);\n\n  switch (language) {\n    case 'javascript':\n    case 'ruby':\n    case 'objc':\n    case 'python':\n      let plurals = mapTypes(language, nestedTypes)\n        .map(s => s.replace(' *', ''))\n        .join('s/');\n\n      return `${mapType(language, type)} (of ${plurals}s)`;\n\n    case 'csharp':\n      if (type === 'Array' && nestedTypes.length == 1) {\n        return `${mapType(language, nestedType)}[]`;\n      }\n      return collectionGeneric(language, type, nestedTypes);\n\n    default:\n      return collectionGeneric(language, type, nestedTypes);\n  }\n}\n\nfunction mapTypes(language, types) {\n  return types.map(t => mapType(language, t));\n}\n\nfunction collectionGeneric (language, type, nestedTypes) {\n  const mapped = mapTypes(language, nestedTypes).join(', ');\n  return `${mapType(language, type)}<${mapped}>`;\n}\n\n/**\n * Wraps the value within the necessary html to ensure that it gets rendered correctly\n * @param value\n * @param shell the shell of the @@docType syntax. Used to determine if a ` is present\n * @returns {string}\n */\nfunction wrap (value, shell, pre, start, end) {\n  value = escapeHtml(value.trim());\n\n  if (pre) {\n    return value;\n  }\n  else if (start) {\n    return start + value + (end || '');\n  }\n  else {\n    return `<dfn class=\"doc-type\">${value}</dfn>`;\n  }\n}\n","import { camelCase } from '../strings'\n\nexport const STYLES = {\n  Const: {\n    upper: ['default']\n  },\n  Method: {\n    upperCamel: ['csharp']\n  },\n  Prop: {\n    upperCamel: ['csharp']\n  },\n  Class: {\n    upperCamel: ['default']\n  },\n  // name acts as default\n  Name: {\n    camel: ['javascript', 'java', 'coffeescript', 'typescript', 'go', 'kotlin', 'scala', 'objc', 'php', 'swift', 'csharp'],\n  }\n}\n\nexport function replaceDocNames (language, pre, content) {\n\n  return content.replace(/`?@@doc(Name|Method|Const|Prop|Class|Param): ?([a-zA-Z0-9?_]*)`?/g, function (shell, type, value) {\n    return wrap(shell, type, pre, () => {\n      if (value) {\n        const style = findStyle(type, language);\n\n        switch (style) {\n          case 'upper':\n            return value.toUpperCase();\n\n          case 'camel':\n            return camelCase(value);\n\n          case 'upperCamel':\n            return camelCase(value, true);\n\n          default:\n            return value;\n        }\n      }\n      else {\n        console.warn('replaceDocNames value is missing:', content); // eslint-disable-line no-console\n        return '';\n      }\n    })\n  })\n}\n\nfunction findStyle(type, language) {\n  let style = Object.keys(STYLES[type] || []).find(style => {\n    let _style = STYLES[type][style];\n    return _style ? _style.indexOf(language) >= 0 : false;\n  })\n\n  // try to find a default style for the type\n  if (!style && language !== 'default') {\n    style = findStyle(type, 'default');\n  }\n\n  // default to name if no specific style is set\n  if (!style && type !== 'Name') {\n    style = findStyle('Name', language);\n  }\n\n  return style;\n}\n\nfunction wrap (shell, type, pre, value) {\n  value = value();\n  if (shell.indexOf('`') === 0 || pre) {\n    return shell.replace(/@@doc(Name|Method|Const|Prop|Class|Param): ?([a-zA-Z0-9?_]*)/, value);\n  }\n  else {\n    return `<dfn class=\"doc-name doc-name--${type.toLowerCase()}\">${value}</dfn>`;\n  }\n}\n","export function replaceDocGlobals (language, pre, content) {\n  return content.replace(/@@docGlobal: ?.*`?/g, function (value) {\n    switch (language) {\n      // languages which should keep the global class\n      case 'java':\n      case 'csharp':\n        return wrap(value.replace(/@@docGlobal: ?/, ''), pre);\n\n      // all other languages remove the global class\n      default:\n        return wrap(value.replace(/@@docGlobal: ?[a-zA-Z\\d]*\\./, ''), pre);\n    }\n  })\n}\n\nfunction wrap (value, pre) {\n  return pre ? value : `<dfn class=\"doc-class\">${value}</dfn>`;\n}\n","import { replaceDocTypes } from './doc-types'\nimport { replaceDocNames } from './doc-names'\nimport { replaceDocGlobals } from './doc-globals'\n\n/**\n * Preprocesses the markdown before sending it through marked. This is used to process\n * doc tokens and any other future extensions that we support that don't require being handled\n * during the marked rendering.\n * @param result\n */\nexport function processDocTokens(result, html, pre) {\n  const language = result.originalLanguage || result.language;\n  const globals = replaceDocGlobals(language, pre, html);\n  const types = replaceDocTypes(language, pre, globals);\n  const names = replaceDocNames(language, pre, types);\n\n  return names;\n}\n","export function jsonDoc(code) {\n  try {\n    let json = JSON.parse(code);\n    const md = [methodName(json)];\n    if (json.desc) {\n      md.push(json.desc);\n    }\n    md.push('```%doc\\nParameters:');\n    md.push(parameters(json));\n    md.push('Return Value:');\n    md.push(returnType(json));\n    if (json.constraints && json.constraints.length) {\n      md.push('Constraints:');\n      md.push(json.constraints.join('\\n'));\n    }\n    md.push('```');\n    if (json.examples && json.examples.length) {\n      md.push('```%doc-block');\n      md.push('#### Examples');\n      md.push(exampleHeader(json));\n      md.push(exampleRows(json));\n      md.push('```');\n    }\n\n    return md.join('\\n');\n  }\n  catch (ex) {\n    return '`Failed to render %jsonblock: ' + ex.message + '`';\n  }\n}\n\nfunction exampleRows(json) {\n  return json.examples.map(exampleRow).join('\\n');\n}\n\nfunction exampleRow(example, index) {\n  const name = example.name || `Example #${index+1}`;\n  let md = `*${name}*|`;\n  md += example.args.map(arg => '`' + JSON.stringify(arg) + '`').join('|');\n  md += `|\\`${example.returns || ''}\\``;\n  return md;\n}\n\nfunction exampleHeader(json) {\n  const line1 = [''];\n  const line2 = [''];\n  Object.keys(getArgs(json)).forEach(key => {\n    line1.push(key)\n    line2.push('');\n  });\n  line1.push('returns');\n  return `${line1.join('|')}\\n-${line2.join('|-')}|-`;\n}\n\nfunction getArgs(json) {\n  return json.args || json.params || json.parameters || {};\n}\n\nfunction methodName(json) {\n  const args = Object.keys(getArgs(json)).map(key => `\\`@@docName:${key}\\``);\n  return `### \\`@@docGlobal:Challenge.@@docMethod:${json.method}\\`(${args.join(', ')})`;\n}\n\nfunction parameters(json) {\n  const args = getArgs(json);\n  const params = Object.keys(args).map(key => {\n    const arg = args[key];\n    const type = typeof arg === 'string' ? arg : arg.type;\n    let md = `@@docName:${key}: @@docType:${type || 'String'}`;\n    if (arg.desc) {\n      md += ` - ${arg.desc}`;\n    }\n\n    return md;\n  });\n\n  return params.join('\\n');\n}\n\nfunction returnType(json) {\n  if (json.returns) {\n    const type = typeof json.returns === 'string' ? json.returns : json.returns.type;\n    let md = `@@docType:${type || 'void'}`;\n    if (json.returns.desc) {\n      md += ` - ${json.returns.desc}`;\n    }\n\n    return md;\n  }\n  return '@@docType:void';\n}\n","import { assignMissing } from './objects'\nimport { processDocTokens } from './doc-tokens'\nimport { jsonDoc } from './json-doc';\n\n\nexport function buildRenderer(marked, options, result) {\n  const renderer = result.renderer = new marked.Renderer();\n\n  const markedOptions = { renderer };\n  assignMissing(markedOptions, options.marked || {});\n\n  // provide the render method, this will also be used later to render nested blocks\n  result.render = (md) => marked(md, markedOptions);\n\n  setupHeader(renderer, options, result);\n  setupCode(options, result);\n}\n\n/**\n *\n * @param renderer\n */\nfunction setupHeader(renderer, options, result) {\n  // heading extensions\n  renderer.heading = function (text, level) {\n    // you can set icons via icon::name\n    const icon = text.match(/icon::([a-z-]*)/);\n    let attributes = '';\n    if (icon) {\n      // indicate that this icon has been used\n      result.icons[icon[1]] = true;\n\n      attributes = ` class=\"${options.iconClassPrefix}${icon[1]}\"`;\n      text = text.replace(/icon::[a-z-]*/, '');\n    }\n\n    // we track headers 1 - 4 and add ids to them so that we can link to them later if we want to\n    if (level < 5) {\n      const header = result.headers[`h${level}`];\n      const index = header.length;\n      attributes += ` id=\"h${level}_${index}\"`;\n      header.push(text);\n    }\n\n    return `<h${level}${attributes}>${text}</h${level}>`;\n  }\n}\n\n/**\n * Handles code blocks in a variety of ways\n * @param options\n * @param result\n */\nfunction setupCode(options, result) {\n  const _code = result.renderer.code;\n\n  // special version of render that will process doc tokens. Needed at times when\n  // tokens are nested inside of pre and should be rendered without tags (but their labels should still be processed)\n  const render = (code, preTokens) => {\n    if (preTokens && options.docTokens) {\n      code = processDocTokens(result, code, true);\n    }\n\n    return result.render(code);\n  }\n\n\n  result.renderer.code = function(code, language) {\n    if (language) {\n      if (language.match(/^if:/)) {\n        return matchIfBlockLanguage(result, language) ? render(code) : '';\n      }\n      else if (language.match(/^if-not:/)) {\n        return matchIfBlockLanguage(result, language) ? '' : render(code);\n      }\n      else if (language.match(/^tab:/)) {\n        return handleTab(result, code, language);\n      }\n      else if (result.extensions.indexOf(language) >= 0) {\n        return handleExtension(options, result, code, language);\n      }\n      else if (language === '%definitions' || language === '%doc') {\n        return wrapInBlockDiv(language, renderDefinitions(result, code, render));\n      }\n      else if (language === '%jsondoc') {\n        return render(jsonDoc(code));\n      }\n      else if (language[0] === '%') {\n        return wrapInBlockDiv(language, result.render(code));\n      }\n\n      // make sure this is a language and not some random tag\n      const foundLanguage = options.findLanguage(language.split(':')[0]);\n\n      if (foundLanguage) {\n        // if filtering is enabled and this is not the active language then filter it out\n        if (options.filterLanguages && foundLanguage !== result.language && result.language) {\n          return '';\n        }\n\n        // if CodeMirror is provided then highlight using that instead\n        if (options.cm) {\n          return highlightCM(options, code, foundLanguage, language);\n        }\n      }\n      // process line numbers, if they are set (i.e. ruby:10) in a naive simple way\n      else if (options.lineNumbers) {\n        code = lineNumbers(code, language);\n      }\n    }\n\n    return wrapLanguage(options, _code.call(result.renderer, code, language), language);\n  }\n}\n\nfunction lineNumbers(code, language, wrapper = '@@ ') {\n  let lineNumber = getLineNumber(language);\n\n  // if there are line numbers, then add them now starting at the start index\n  if (lineNumber > 0) {\n    code = code.split('\\n').map(line => {\n      return `${wrapper.replace('@@', lineNumber++)}${line}`\n    }).join('\\n');\n  }\n\n  return code;\n}\n\nfunction wrapLanguage(options, code, language) {\n  // if we have reached this point then CM isn't enabled and we need to\n  if (language && options.languageWrapper) {\n    if (typeof options.languageWrapper === 'function') {\n      code = options.languageWrapper(code, language);\n    }\n    else {\n      code = options.languageWrapper.replace('{slot}', code);\n    }\n  }\n\n  return code;\n}\n\nfunction highlightCM(options, code, language, raw) {\n  const el = window.document.createElement('div');\n  options.cm.runMode(code, options.findMode(language), el);\n\n  let codeHtml = el.innerHTML;\n  if (options.lineNumbers) {\n    codeHtml = lineNumbers(codeHtml, raw, '<span class=\"cm-line-number\">@@</span>');\n  }\n\n  const result = `<pre class=\"cm-runmode cm-s-${options.theme}\"><code>${codeHtml}</code></pre>`;\n  return wrapLanguage(options, result, language);\n}\n\nfunction getLineNumber(language) {\n  const parts = language.split(':');\n  return parts.length > 1 ? parseInt(parts[1], 10) : null;\n}\n\nfunction wrapInBlockDiv(type, contents) {\n  return `<div class=\"block block--${type.replace(/^%/, '')}\">${contents}</div>`;\n}\n\nfunction matchIfBlockLanguage(result, language) {\n  return language.replace(/^if(-not)?: ?/, '').split(',').indexOf(result.originalLanguage) >= 0;\n}\n\nfunction handleTab(result, code, language) {\n  // parts should be up to tab:LABEL with language being optional\n  const parts = language.split(':');\n  let label = parts[1].replace(/\\+/g, ' ');\n  result.tabs[label] = `${result.render(code)}`;\n  return '';\n}\n\n/**\n * If the extension value is a function, it will treat it as a render function, otherwise it will\n * assume the extension value is a string and treat it as a template with {code} as the code placeholder.\n * @param options\n * @param code\n * @param language\n */\nfunction handleExtension(options, result, code, language) {\n  const ext = options.extensions[language]\n\n  if (typeof ext.code === 'function') {\n    return ext.code(code, options);\n  }\n  else {\n    return ext.code.replace('{code}', code);\n  }\n}\n\n/**\n *\n * @param result\n * @param code\n * @returns {string}\n */\nfunction renderDefinitions (result, code, render) {\n  var html = '<dl>';\n  if (code) {\n    code.split('\\n').forEach(line => {\n      if (line.match(/^#/)) {\n        html += render(line);\n      }\n      else if (line.match(/: *$/)) {\n        html += `<dt>${line.replace(/:$/, '')}</dt>`;\n      }\n      else {\n        // if line starts with 4 white spaces, a tab or a ` block, then consider it a pre tag and don't render dfn\n        html += `<dd>${render(line, !!line.match(/^(\\t|\\s{4}|`)/))}</dd>`;\n      }\n    });\n  }\n\n  return html + '</dl>';\n}\n","import { assignMissing } from './objects'\nimport { buildRenderer } from './renderer'\nimport { processDocTokens } from './doc-tokens'\n\nexport const defaultOptions = {\n  // these are the options passed to marked directly\n  marked: {},\n  // languages that should be treated as extensions. You can configure how each gets handled\n  extensions: {\n    mermaid: {\n      // code handler\n      code: code => `<div class=\"mermaid\">${code}</div>`,\n      // will lazy load script automatically\n      src: 'https://cdn.rawgit.com/knsv/mermaid/6.0.0/dist/mermaid.min.js',\n      afterRender: () => window.mermaid && window.mermaid.init()\n    },\n  },\n  // set to a method that that will receive a language and return the mapped\n  // name. if no name is returned, it is assumed that the language is an extension.\n  // The default method only handles a default set of languages.\n  findLanguage: (language) => defaultLanguages.indexOf(language) >= 0 ? language: null,\n\n  // used with CodeMirror.runMode, used to find the mode of the language. By default will just return the language\n  findMode: (language) => language,\n\n  // The highlight theme to add, only used with cm runMode\n  theme: 'neo',\n\n  // you can set icons within headers using icon::ICONNAME, this setting determines the icon class prefix used\n  iconClassPrefix: 'icon-',\n\n  // set to a value that should wrap standard languages. Use \"{slot}\" to indicate where the code should be inserted: i.e.\n  // '<div class=\"tab\">{code}</div>'. Can also be a function which takes (code, language) as its parameters.\n  languageWrapper: null,\n\n  // the language that should be used for filtering out all other languages\n  language: null,\n\n  // true if languages should be filtered\n  filterLanguages: true,\n\n  // if the language value is not set, or is set to a value not found within the markdown, this\n  // setting will default the language to the first one found within the markdown.\n  defaultLanguageToFirst: true,\n\n  // true if line numbers should be added to highlighted code (if a starting line number is configured for the block)\n  lineNumbers: true,\n\n  // css class used to display a line number gutter, which can be used to try to create an opacity layer\n  // which will style the cm-number values differently. Set to null to disable adding a gutter.\n  lineNumbersGutter: 'cm-runmode-linenumbers-gutter',\n\n  // true if doc tokens should be parsed\n  docTokens: true,\n\n  // if set to an instance of js-yaml, it will process meta data at the top of the markdown.\n  jsYaml: null,\n\n  // If set to CodeMirror class, it will use CodeMirror.runMode to process syntax highlighting\n  // Note: make sure to import codemirror/addon/runmode/runmode.js first.\n  cm: null,\n\n  // set to automatically load a CM language. This is provided by default but you can override if you wish\n  // to override. This option is only used if both cm and loadScript are set.\n  // You can set this to null if you do not wish or need to load languages dynamically\n  loadCMLanguage: (language, options) => {\n    return options.loadScript(`//cdnjs.cloudflare.com/ajax/libs/codemirror/${options.cm.version}/mode/${language}/${language}.min.js`);\n  },\n\n  // If you wish to support loading external extension scripts, you should set this to a\n  // function that takes a url and returns a promise. Note that this function will need to be responsible\n  // for not reloading the same scripts if requested more than once, this library does not take care of caching.\n  loadScript: null,\n\n  // if set to a function, will be called back after all external scripts have loaded\n  onLoaded: null\n};\n\nexport const defaultLanguages = [\n  'c', 'clojure', 'coffeescript', 'cpp', 'csharp', 'elixir', 'erlang', 'fsharp',\n  'go', 'groovy', 'haskell', 'java', 'javascript', 'kotlin', 'objc', 'ocaml', 'php', 'python',\n  'r', 'ruby', 'scala', 'shell', 'solidity', 'sql', 'swift', 'typescript'\n]\n\n/**\n * Processes the markdown using marked along with the many extensions this library provides\n * @param marked The marked library, must be passed in since it is not included within this library as a dependency\n * @param markdown The markdown to process\n * @param options The extended set of options, as well as marked options. See defaultOptions for more details.\n * @returns {{originalLanguage, language, languages: [], extensions: [], tabs: {}, headers: {h1: Array, h2: Array, h3: Array, h4: Array}, icons: [], raw: *, preprocessed: *}}\n */\nexport function process(marked, markdown, options = {}) {\n  assignMissing(options, defaultOptions);\n\n  const result = {\n    originalLanguage: options.language,\n    language: options.language,\n    languages: {},\n    extensions: {},\n    tabs: {},\n    headers: {h1: [], h2: [], h3: [], h4: []},\n    icons: {},\n    raw: markdown,\n    preprocessed: markdown\n  };\n\n  if (options.jsYaml) {\n    processMeta(options, result);\n  }\n\n  processBlocks(options, result);\n  if (options.defaultLanguageToFirst) {\n    processLanguage(result);\n  }\n\n  buildRenderer(marked, options, result);\n\n  var html = null;\n  result.html = () => html || (html = render(options, result));\n  result.afterRender = afterRenderFn(options, result);\n\n  // convert objects which have been acting as basic sets to an array\n  ['languages', 'extensions', 'icons']\n    .forEach(key => result[key] = Object.keys(result[key]));\n\n  if (options.loadScript) {\n    processExternalScripts(options, result);\n  }\n\n  return result;\n}\n\nfunction render(options, result) {\n  let html = result.render(result.preprocessed);\n\n  if (options.docTokens) {\n    html = processDocTokens(result, html);\n  }\n\n  return html;\n}\n\n/**\n * Creates the afterRender function that is added to the result, which can be called once the\n * processed html has been added to the DOM to initialize any extensions that may have been loaded.\n * @param options\n * @param result\n * @returns {Function}\n */\nfunction afterRenderFn(options, result) {\n  return function() {\n    result.extensions.forEach(ext => {\n      const config = options.extensions[ext];\n      if (config && config.afterRender) {\n        config.afterRender.apply(result, arguments);\n      }\n    });\n  }\n}\n\n/**\n * Will loop through extensions and languages and try to dynamically load scripts.\n * @param options\n * @param result\n */\nfunction processExternalScripts(options, result) {\n  const promises = [];\n  result.extensions.forEach(ext => {\n    const config = options.extensions[ext];\n    if (config && config.src) {\n      promises.push(options.loadScript(config.src));\n    }\n  });\n\n  // automatically load the CM language that is shown\n  if (options.cm && options.loadCMLanguage) {\n    // if we filter languages then we only need to load the one being shown\n    if (options.filterLanguages && result.language) {\n      promises.push(options.loadCMLanguage(result.language, options));\n    }\n    // otherwise we need to load them all\n    else if (!options.filterLanguages && result.languages.length) {\n      result.languages.forEach(language => {\n        promises.push(options.loadCMLanguage(language, options));\n      });\n    }\n  }\n\n  Promise.all(promises).then(() => {\n    if (options.onLoaded) {\n      options.onLoaded(result);\n    }\n  });\n}\n\n/**\n * Processes yaml content at the top of the markdown, marked starting by a --- and ending with a ...\n * @param options\n * @param result\n */\nfunction processMeta(options, result) {\n  result.preprocessed = result.preprocessed.replace(/^---\\n(.*\\n)*\\.\\.\\. *\\n\\n?/, meta => {\n    const yaml = meta.replace(/^---\\n/, '').replace(/\\n\\.\\.\\. *\\n?/, '');\n    result.meta = options.jsYaml.safeLoad(yaml);\n\n    return '';\n  });\n}\n\n/**\n * if no language was provided, or the one provided is not in the list of supported languages,\n * then switch to the first language found\n * @param result\n */\nfunction processLanguage(result) {\n  if (!result.language || !result.languages[result.language]) {\n    result.language = Object.keys(result.languages)[0];\n  }\n}\n\n/**\n * Loops through all ``` style blocks and figures out which are languages and which are\n * possibly extensions\n * @param markdown\n * @param options\n * @param result\n */\nfunction processBlocks(options, result) {\n  let blocks = result.preprocessed.match(/^(```|~~~) ?(.*) *$/gm) || [];\n  blocks = blocks.map(m => m.replace(/(```|~~~) ?/g, ''));\n\n  // loop through each block and track which are languages and which are extensions\n  blocks.forEach((text) => {\n    if (text) {\n      text = text.replace(/^if(-not)?: ?/, '').split(':')[0];\n\n      text.split(',').forEach(name => {\n        // % is a special token, we know these aren't either languages or extensions\n        if (name.indexOf('%') === -1) {\n          // if an extension has been defined for the language, track it now\n          if (options.extensions[name]) {\n            result.extensions[name] = true;\n          }\n          else {\n            const language = options.findLanguage(name);\n            if (language) {\n              result.languages[language] = true;\n            }\n          }\n        }\n      })\n    }\n  });\n}\n"],"names":["assignMissing","target","source","keys","forEach","key","upperCaseWords","str","replace","a","toUpperCase","camelCase","pascal","cased","lowerCaseFirst","toLowerCase","substr","escapeHtml","text","unescapeHtml","TYPES","NULLABLE","regex","replaceDocTypes","language","pre","content","shell","codeStart","value","codeEnd","nullable","match","trim","indexOf","parts","split","collectionType","mapType","mapNullable","wrap","config","default","type","_default","map","mapped","_alias","nestedType","nestedTypes","plurals","mapTypes","s","join","length","collectionGeneric","types","t","start","end","STYLES","replaceDocNames","style","findStyle","warn","Object","find","_style","replaceDocGlobals","processDocTokens","result","html","originalLanguage","globals","names","jsonDoc","code","json","JSON","parse","md","methodName","desc","push","parameters","returnType","constraints","examples","exampleHeader","exampleRows","ex","message","exampleRow","example","index","name","args","stringify","arg","returns","line1","line2","getArgs","params","method","buildRenderer","marked","options","renderer","Renderer","markedOptions","render","setupHeader","heading","level","icon","attributes","icons","iconClassPrefix","header","headers","setupCode","_code","preTokens","docTokens","matchIfBlockLanguage","handleTab","extensions","handleExtension","wrapInBlockDiv","renderDefinitions","foundLanguage","findLanguage","filterLanguages","cm","highlightCM","lineNumbers","wrapLanguage","call","wrapper","lineNumber","getLineNumber","line","languageWrapper","raw","el","window","document","createElement","runMode","findMode","codeHtml","innerHTML","theme","parseInt","contents","label","tabs","ext","defaultOptions","mermaid","init","defaultLanguages","loadScript","version","process","markdown","h1","h2","h3","h4","jsYaml","defaultLanguageToFirst","afterRender","afterRenderFn","preprocessed","apply","arguments","processExternalScripts","promises","src","loadCMLanguage","languages","all","then","onLoaded","processMeta","yaml","meta","safeLoad","processLanguage","processBlocks","blocks","m"],"mappings":"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"}